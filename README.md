# üè≠ Otkroimosprom Backend

Backend —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–æ—Å–∫–æ–≤—Å–∫–∏—Ö –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–ø–∞–Ω–∏—è–º–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏—è–º–∏

- **CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏** —Å –∫–æ–º–ø–∞–Ω–∏—è–º–∏
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –º–µ—Ç—Ä–∏–∫–∞–º (–æ—Ç—Ä–∞—Å–ª—å, —Ä–∞–∑–º–µ—Ä, —Å—Ç–∞—Ç—É—Å, –≥–æ–¥)
- **–ú–∞—Å—Å–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥** –∏–∑ CSV/JSON —Ñ–∞–π–ª–æ–≤
- **–ü–æ–∏—Å–∫** –ø–æ –ò–ù–ù, –æ—Ç—Ä–∞—Å–ª–∏, —Å—Ç–∞—Ç—É—Å—É
- **–°–≤—è–∑—ã–≤–∞–Ω–∏–µ** –∫–æ–º–ø–∞–Ω–∏–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### üìà –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤

- **7 —Ç–∏–ø–æ–≤ –≥—Ä–∞—Ñ–∏–∫–æ–≤**: –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–µ –∫–∞—Ä—Ç—ã, —Ç–æ—á–µ—á–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏, –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –∏ –¥—Ä.
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è** —Å Plotly
- **–≠–∫—Å–ø–æ—Ä—Ç** –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- **–ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** –≥—Ä–∞—Ñ–∏–∫–æ–≤

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- **JWT —Ç–æ–∫–µ–Ω—ã** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** –∏ **–≤—Ö–æ–¥** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### üìã –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö

- **–≠–º—É–ª—è—Ç–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ CSV –∏ JSON** —Ñ–æ—Ä–º–∞—Ç–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- **–£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤**

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **FastAPI** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Python
- **SQLModel** - ORM –Ω–∞ –æ—Å–Ω–æ–≤–µ Pydantic –∏ SQLAlchemy
- **PostgreSQL** - —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Plotly** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- **Pydantic** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **JWT** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- PostgreSQL 12+
- Docker (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**

```bash
git clone https://github.com/Hack2025MosProm/backend.git
cd otkroimosprom-backend
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

```bash
pip install -r requirements.txt
```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

```bash
createdb otkroimosprom
```

4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**

```bash
cp .env.example .env
```

5. **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
uvicorn src.main:app --reload --host 0.0.0.0 --port 8080

# –ò–ª–∏ —á–µ—Ä–µ–∑ Docker
docker-compose up -d
```

### Docker

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up --build

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥  | –ü—É—Ç—å                           | –û–ø–∏—Å–∞–Ω–∏–µ                 |
| ------ | ------------------------------ | ------------------------ |
| `POST` | `/api/v1/auth/register`        | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `POST` | `/api/v1/auth/login`           | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è              |
| `GET`  | `/api/v1/companies/`           | –°–ø–∏—Å–æ–∫ –∫–æ–º–ø–∞–Ω–∏–π          |
| `GET`  | `/api/v1/companies/filter`     | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–ø–∞–Ω–∏–π      |
| `POST` | `/api/v1/companies/parse/bulk` | –ú–∞—Å—Å–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥         |
| `POST` | `/api/v1/graphs/generate`      | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞        |
| `GET`  | `/api/v1/graphs/`              | –°–ø–∏—Å–æ–∫ –≥—Ä–∞—Ñ–∏–∫–æ–≤          |

### –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö

#### –ú–∞—Å—Å–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥

```bash
curl -X POST "http://localhost:8080/api/v1/companies/parse/bulk" \
  -H "Authorization: Bearer <token>"
```

#### –ü–æ–∏—Å–∫ –ø–æ –ò–ù–ù

```bash
curl -X POST "http://localhost:8080/api/v1/companies/parse/search-by-inn" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"query": "7721840520", "save_to_db": true}'
```

#### –ü–æ–∏—Å–∫ –ø–æ –æ—Ç—Ä–∞—Å–ª–∏

```bash
curl -X POST "http://localhost:8080/api/v1/companies/parse/search-by-industry" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"query": "IT", "save_to_db": true}'
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤

#### –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞

```bash
curl -X POST "http://localhost:8080/api/v1/graphs/generate" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "graph_type": "treemap_prod",
    "company_ids": [1, 2, 3]
  }'
```

#### –ú–∞—Å—Å–æ–≤–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤

```bash
curl -X DELETE "http://localhost:8080/api/v1/graphs/bulk" \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "delete_all": true,
    "graph_ids": []
  }'
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
postgresql_uri=postgresql+psycopg2://postgres:<password>@<server>:<port>/<db_name>

# JWT
jwt_secret=your-jwt-secret
access_token_expire_minutes=60

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
logging_level=INFO
logging_format=standart
port=8080
host=0.0.0.0
reload=1
workers=1
```

## üìä –¢–∏–ø—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤

| –¢–∏–ø            | –û–ø–∏—Å–∞–Ω–∏–µ              | –°–µ–∫—Ç–æ—Ä            |
| -------------- | --------------------- | ----------------- |
| `treemap_prod` | –î—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è –∫–∞—Ä—Ç–∞     | –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ      |
| `scatter_busy` | –¢–æ—á–µ—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫       | –ó–∞–Ω—è—Ç–æ—Å—Ç—å         |
| `norm_export`  | –ù–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã | –≠–∫—Å–ø–æ—Ä—Ç           |
| `pie_prod`     | –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞    | –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ      |
| `area_ecology` | –î–∏–∞–≥—Ä–∞–º–º–∞ —Å –æ–±–ª–∞—Å—Ç—è–º–∏ | –≠–∫–æ–ª–æ–≥–∏—è          |
| `hist_energy`  | –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞           | –≠–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ |
| `table_invest` | –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞       | –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏        |

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- **–£—Ä–æ–≤–Ω–∏**: DEBUG, INFO, WARNING, ERROR
- **–§–æ—Ä–º–∞—Ç**: JSON —Å —Ü–≤–µ—Ç–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
- **–§–∞–π–ª—ã**: `logs/app.log`

### –ú–µ—Ç—Ä–∏–∫–∏

- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- **JWT —Ç–æ–∫–µ–Ω—ã** —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** —Å bcrypt
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- **–ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞** –∫ –∫–æ–º–ø–∞–Ω–∏—è–º –∏ –≥—Ä–∞—Ñ–∏–∫–∞–º
- **–ó–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π** —á–µ—Ä–µ–∑ ORM

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Production

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
export DATABASE_URL=postgresql://...
export SECRET_KEY=...

# –ó–∞–ø—É—Å–∫ —Å Gunicorn
gunicorn src.main:app -w 4 -k uvicorn.workers.UvicornWorker
```

2. **Docker**

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t otkroimosprom-backend .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8080:8080 otkroimosprom-backend
```

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
git clone https://github.com/Hack2025MosProm/backend.git
cd otkroimosprom-backend

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
.venv\Scripts\activate.ps1  # Windows Powershell

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

- **API —Å–ª–æ–π**: `src/api/` - —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **–ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞**: `src/repositories/` - —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
- **–ú–æ–¥–µ–ª–∏**: `src/models/` - —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- **–£—Ç–∏–ª–∏—Ç—ã**: `src/csv_reader/`, `src/parser/` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏

## üìù Changelog

### MVP

- ‚ú® –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–ª–∏–∑
- üîê –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏—è–º–∏
- üìà –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
- üîç –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
- üìö API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [docs/api.v1.md](docs/api.v1.md)
- **Issues**: GitHub Issues

---

**–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –º–æ—Å–∫–æ–≤—Å–∫–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏**
